#!/usr/bin/python3
#Interpolação Polinomial com Matriz -> Ax = b
import numpy as np

x1=0.0;x2=0.5;x3=1.0;x4=1.5;x5=2.0;x6=2.5;x7=3.0;x8=3.5;x9=4.0;x10=4.5;x11=5.0;x12=5.5
x13=6.0;x14=6.5;x15=7.0;x16=7.5;x17=8.0;x18=8.5;x19=9.0;x20=9.5;x21=10.0;x22=0.20;y1=-1.0
y2=-0.88;y3=-0.85;y4=-0.8;y5=-0.7;y6=-0.6;y7=-0.56;y8=-0.48;y9=-0.4;y10=-0.415;y11=-0.51
y12=-0.59;y13=-0.62;y14=-0.64;y15=-0.7;y16=-0.68;y17=-0.88;y18=-0.373;y19=0;y20=0.6;y21=1.37;y22=-1

A = np.array([[1, x1, x1**2, x1**3, x1**4, x1**5, x1**6],
              [1, x2, x2**2, x2**3, x2**4, x2**5, x2**6],
              [1, x3, x3**2, x3**3, x3**4, x3**5, x3**6],
              [1, x4, x4**2, x4**3, x4**4, x4**5, x4**6],
              [1, x5, x5**2, x5**3, x5**4, x5**5, x5**6],
              [1, x6, x6**2, x6**3, x6**4, x6**5, x6**6],
              [1, x7, x7**2, x7**3, x7**4, x7**5, x7**6],
              [1, x8, x8**2, x8**3, x8**4, x8**5, x8**6],
              [1, x9, x9**2, x9**3, x9**4, x9**5, x9**6],
              [1, x10, x10**2, x10**3, x10**4, x10**5, x10**6],
              [1, x11, x11**2, x11**3, x11**4, x11**5, x11**6],
              [1, x12, x12**2, x12**3, x12**4, x12**5, x12**6],
              [1, x13, x13**2, x13**3, x13**4, x13**5, x13**6],
              [1, x14, x14**2, x14**3, x14**4, x14**5, x14**6],
              [1, x15, x15**2, x15**3, x15**4, x15**5, x15**6],
              [1, x16, x16**2, x16**3, x16**4, x16**5, x16**6],
              [1, x17, x17**2, x17**3, x17**4, x17**5, x17**6],
              [1, x18, x18**2, x18**3, x18**4, x18**5, x18**6],
              [1, x19, x19**2, x19**3, x19**4, x19**5, x19**6],
              [1, x20, x20**2, x20**3, x20**4, x20**5, x20**6],
              [1, x21, x21**2, x21**3, x21**4, x21**5, x21**6],
              [1, x22, x22**2, x22**3, x22**4, x22**5, x22**6]])

C=A.T@np.array([[y1],[y2],[y3],[y4],[y5],[y6],[y7],[y8],[y9],[y10],[y11],[y12],[y13],[y14],[y15],[y16],[y17],[y18],[y19],[y20],[y21],[y22]])

ATI=(np.linalg.inv(A.T@A))

a = (ATI@C)[0][0]
b = (ATI@C)[1][0]
c = (ATI@C)[2][0]
d = (ATI@C)[3][0]
e = (ATI@C)[4][0]
f = (ATI@C)[5][0]
g = (ATI@C)[6][0]

print(("Polinomio -> y = (%s) + (%s*x) + (%s*x^2) + (%s*x^3) + (%s*x^4) + (%s*x^5) + (%s*x^6)"%(a,b,c,d,e,f,g)).replace('e','*10^'))
